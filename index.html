<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Avinya</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --romantic-pink: #ffb7c5;
            --deep-rose: #d81b60;
            --white: #ffffff;
            --transition-speed: 1.2s;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            height: 100vh; display: flex; justify-content: center; align-items: center;
            font-family: 'Quicksand', sans-serif; overflow: hidden;
            transition: background var(--transition-speed) ease;
            background: #e1f5fe; 
        }

        /* Elements */
        .scenery { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
        .cloud { position: absolute; background: white; border-radius: 50px; opacity: 0.6; animation: floatCloud 25s linear infinite; }
        @keyframes floatCloud { from { left: -150px; } to { left: 110vw; } }
        .petal { position: absolute; top: -10%; font-size: 20px; animation: fall linear infinite; opacity: 0.8; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }

        /* Mood Backgrounds */
        body.day { background: #e1f5fe; }
        body.sunset { background: linear-gradient(to bottom, #ff9e80, #fce4ec); }
        body.night { background: linear-gradient(to bottom, #1a237e, #4a148c); }

        /* Story Card */
        .card-container { display: none; width: 85%; max-width: 340px; perspective: 1000px; z-index: 10; }
        .mini-card {
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            padding: 35px 25px; border-radius: 30px; border: 2px solid white;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15); text-align: center;
            transform-style: preserve-3d; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .emoji-header { font-size: 50px; margin-bottom: 15px; display: block; }

        h2 { font-family: 'Dancing Script', cursive; font-size: 1.8rem; color: var(--deep-rose); margin-bottom: 12px; }
        p { line-height: 1.6; font-size: 1.05rem; min-height: 5em; font-weight: 500; color: #444; }

        .nav-btn { margin-top: 20px; padding: 12px 30px; background: var(--romantic-pink); color: white; border: none; border-radius: 25px; font-weight: 600; cursor: pointer; transition: 0.3s; }
        .nav-btn:active { transform: scale(0.95); }

        /* Envelopes */
        .envelope-wrapper { cursor: pointer; text-align: center; z-index: 20; }
        .envelope { width: 220px; height: 140px; background: var(--romantic-pink); border-radius: 0 0 10px 10px; position: relative; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .envelope::before { content: ''; position: absolute; top: 0; left: 0; border-left: 110px solid transparent; border-right: 110px solid transparent; border-top: 85px solid #ff9ead; transform-origin: top; transition: 0.5s; z-index: 2; }
        .open .envelope::before { transform: rotateX(180deg); }
        .heart-seal { position: absolute; top: 45px; left: 50%; transform: translateX(-50%); font-size: 45px; animation: beat 1.5s infinite; z-index: 3; }
        @keyframes beat { 0%, 100% { transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.2); } }

        /* Typewriter Cursor */
        .typing::after { content: 'üå∏'; animation: blink 0.8s infinite; margin-left: 5px; }
        @keyframes blink { 50% { opacity: 0; } }

        #music-btn { position: fixed; top: 20px; right: 20px; background: white; border: none; width: 40px; height: 40px; border-radius: 50%; display: none; z-index: 100; font-size: 18px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="day">

    <div class="scenery" id="scenery-objects"></div>
    
    <audio id="bg-music" loop preload="auto">
        <source src="https://files.catbox.moe/979685.mp3" type="audio/mpeg">
    </audio>

    <button id="music-btn" onclick="toggleMusic()">üéµ</button>

    <div id="intro" class="envelope-wrapper" onclick="startStory()">
        <div class="envelope"><div class="heart-seal">‚ù§Ô∏è</div></div>
        <p style="margin-top: 25px; color: var(--deep-rose); font-weight: 600;">Tap to open, Avinya</p>
    </div>

    <div id="poem-intro" class="envelope-wrapper" style="display: none;" onclick="startPoem()">
        <div class="envelope" style="background: #d81b60;"><div class="heart-seal">‚úâÔ∏è</div></div>
        <p style="margin-top: 25px; color: var(--deep-rose); font-weight: 600;">Wait, there's more...</p>
    </div>

    <div class="card-container" id="card-wrap">
        <div class="mini-card" id="main-card">
            <span class="emoji-header" id="emoji-display">üå∏</span>
            <h2 id="title"></h2>
            <p id="text" class="typewriter"></p>
            <button id="nextBtn" class="nav-btn" onclick="nextStep()">Next Page ‚Üí</button>
        </div>
    </div>

    <script>
        const music = document.getElementById('bg-music');
        
        const messages = [
            { title: "üå∏ Hey Avinya", text: "This isn‚Äôt anything dramatic. Just a quiet pause in a moving world where a thought chose to stay.", mood: "day", emoji: "üê∞" },
            { title: "‚ú® Connections", text: "Some connections don‚Äôt announce themselves. They arrive gently, through simple, honest conversations.", mood: "day", emoji: "üê±" },
            { title: "üå∑ Since November", text: "Distance hasn't stopped words from flowing naturally. Every exchange has been a quiet highlight.", mood: "sunset", emoji: "üêº" },
            { title: "üí´ You're Enough", text: "Just a gentle reminder that being you, exactly the way you are, is already more than enough.", mood: "sunset", emoji: "üê®" }
        ];

        const poems = [
            { title: "üåô Softly", text: "There is distance ‚Äî like space between two notes of the same song. Not heavy, just present.", mood: "night", emoji: "ü¶ä" },
            { title: "‚≠ê Time", text: "Time behaves differently here. Unbothered by clocks, just the comfort of being understood.", mood: "night", emoji: "üêª" },
            { title: "‚úçÔ∏è A Smile", text: "If this made you smile even for a single second, then it did exactly what it was meant to do.", mood: "night", emoji: "ü¶å" }
        ];

        let index = 0;
        let isPoemMode = false;
        let isTyping = false;

        function initScenery() {
            const sc = document.getElementById('scenery-objects');
            // Floating Clouds
            for(let i=0; i<4; i++) {
                let c = document.createElement('div');
                c.className = 'cloud';
                c.style.top = (Math.random()*30) + '%';
                c.style.width = '120px'; c.style.height = '40px';
                c.style.animationDelay = (i * 5) + 's';
                sc.appendChild(c);
            }
            // Falling Petals
            setInterval(() => {
                let p = document.createElement('div');
                p.className = 'petal';
                p.innerHTML = 'üå∏';
                p.style.left = Math.random() * 100 + 'vw';
                p.style.animationDuration = (Math.random() * 3 + 3) + 's';
                sc.appendChild(p);
                setTimeout(() => p.remove(), 5000);
            }, 700);
        }

        function startStory() {
            document.getElementById('intro').classList.add('open');
            music.volume = 0.5;
            music.play().catch(e => console.log("Audio play interaction required"));
            document.getElementById('music-btn').style.display = 'block';
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });

            setTimeout(() => {
                document.getElementById('intro').style.display = 'none';
                document.getElementById('card-wrap').style.display = 'block';
                showPage();
            }, 600);
        }

        function startPoem() {
            document.getElementById('poem-intro').classList.add('open');
            confetti({ particleCount: 100, spread: 70 });
            setTimeout(() => {
                document.getElementById('poem-intro').style.display = 'none';
                document.getElementById('card-wrap').style.display = 'block';
                isPoemMode = true; index = 0;
                showPage();
            }, 600);
        }

        function showPage() {
            const data = isPoemMode ? poems[index] : messages[index];
            const card = document.getElementById('main-card');
            
            document.body.className = data.mood;
            document.getElementById('emoji-display').textContent = data.emoji;
            
            card.style.transform = "rotateY(90deg)";
            setTimeout(() => {
                document.getElementById('title').textContent = data.title;
                document.getElementById('text').textContent = "";
                card.style.transform = "rotateY(0deg)";
                typeText(data.text);
            }, 300);
        }

        function typeText(msg) {
            isTyping = true;
            let i = 0;
            const el = document.getElementById('text');
            el.classList.add('typing');
            
            function step() {
                if (i < msg.length) {
                    el.textContent += msg.charAt(i);
                    i++;
                    setTimeout(step, 45);
                } else {
                    el.classList.remove('typing');
                    isTyping = false;
                    if(isPoemMode && index === poems.length -1) {
                        document.getElementById('nextBtn').textContent = "With love, Yatin ‚ù§";
                    }
                }
            }
            step();
        }

        function nextStep() {
            if (isTyping) return;
            const currentArray = isPoemMode ? poems : messages;
            
            if (index < currentArray.length - 1) {
                index++;
                showPage();
                if(index % 2 === 0) confetti({ particleCount: 40, spread: 50 });
            } else if (!isPoemMode) {
                document.getElementById('card-wrap').style.display = 'none';
                document.getElementById('poem-intro').style.display = 'block';
            } else {
                confetti({ particleCount: 200, spread: 100 });
            }
        }

        function toggleMusic() { music.paused ? music.play() : music.pause(); }

        initScenery();
    </script>
</body>
</html>
